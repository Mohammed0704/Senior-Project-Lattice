<!DOCTYPE html>
<html>
<link rel='stylesheet' href='/static_files/main.css' />
<link rel='stylesheet' href='/static_files/data_object_pages.css' />
 
<center>
  <head>
      <title>Data Object Management Portal</title>
      <b>
          <h1 style="margin-bottom: 1.5%;">Data Object Management Portal</h1>
      </b>
  </head>
  
  <body>
    <div id="outer-content-box">
      <div id="connectionSchemaTableURL" name="{{ connectionName }}/{{ schemaName }}/{{ tableName }}"></div>
      <p id="sub-title"><b>Connection:</b> {{ connectionName }}</p>
      <p id="sub-title"><b>Schema:</b> {{ schemaName }}</p>
      <p id="sub-title"><b>Table:</b> {{ tableName }}</p>
      <div id="inner-content-box">
        <table id="inner-table">
            <tr id="table-header">
                <td><p id="title">Columns</p></td>
                <td><p id="title">Tags</p></td>
                <td><p id="title"></p></td>
            </tr>
          {% for column in columnList %}
          <tr>
            <td><p class="column-value"> {{ column }} </p></td>
            <td class="tag-cell">
              <center>
              {% if columnTagDict|length > 0 %}
                {% for columnKey, tagList in columnTagDict.items() %}
                  {% if columnKey == column %}
                    {% for tag in tagList %}
                      <div class="tag-cell-tag" name="{{ column }}"><button class="remove-button remove-button1" name="{{ tag }}">{{ tag }} &times</button></div>
                    {% endfor %}
                  {% endif %}
                {% endfor %}
              {% endif %}
              </center>
            </td>
            <td class="add-cell">
              <center>
              <select style="font-size: 16px; height: 28px;" name=tags method="GET" action="/">
                <option id="default-tag-option" selected value> -- Select a tag -- </option>
                {% for tag in tagList %}
                <option value= "{{ tag }}">{{ tag }}</option>
                {% endfor %}
              </select>
              <button class="add-button add-button1" name="test6" value="">Add</button>
              </center>
            </td>
          </tr>
          {% endfor %}
        </table>
      </div>
      <a href="/objects/{{ connectionName }}/{{ schemaName }}" class="button button1">Back</a> 
    </div>
  </body>
</center>

<script src="/static_files/jquery-3.1.1.js"></script>

<script>
$(".remove-button").click(function(event)
{
  tagToDeleteName = $(this).attr("name")
  console.log("Removing " + tagToDeleteName + " tag...");
  columnContainingTag = $(this).closest(".tag-cell-tag").attr("name")
  $(this).closest(".tag-cell-tag").remove()
  connectionSchemaTableURL = $("#" + "connectionSchemaTableURL").attr("name")

  $.ajax({
    url: "/objects/" + connectionSchemaTableURL + "/" + columnContainingTag + "/remove/" + tagToDeleteName,
    type: "delete"
  });

});

</script>

</html>